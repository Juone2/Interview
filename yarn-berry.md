# yarn-berry

## 기존 yarn classic ( yarn 1.x ) 문제점

기존의 node_ moudles는 많은 파일들이 매우 큰 공간을 차지하고 의존성 확인이 어려움.

## Plug’n’Play (PnP)

Yarn Berry는 node_modules를 생성하지 않음. 

대신 `.yarn/cache` 폴더에 의존성의 정보가 저장되고, `.pnp.cjs` 파일에 의존성을 찾을 수 있는 정보가 기록된다. `.pnp.cjs`를 이용하면 어떤 패키지가 어떤 라이브러리에 의존하는지, 각 라이브러리는 어디에 위치하는지를 바로 알 수 있음.

```jsx
/* react 패키지 중에서 */
["react", [
  /* npm:17.0.1 버전은 */
  ["npm:17.0.1", {
    /* 이 위치에 있고 */
    "packageLocation": "./.yarn/cache/react-npm-17.0.1-98658812fc-a76d86ec97.zip/node_modules/react/",
    /* 이 의존성들을 참조한다. */
    "packageDependencies": [
      ["loose-envify", "npm:1.4.0"],
      ["object-assign", "npm:4.1.1"]
    ],
  }]
]],
```

→ Zip 아카이브로 의존성 관리 됨. 

**아카이브란**

> 백업 또는 다른 장소로의 이동시키는 등의 목적을 위해 컴퓨터 파일들을 뭉쳐놓은 모음.
> 
- node_module을 생성할 필요가 없음. → 설치가 빨리 됨.
- 각 패키지는 하나의 버전의 zip 아카이브만 가지기 때문에 중복 설치 X → 용량을 크게 아낄 수 있음.
- 의존성을 구성하는 파일이 많지 않으므로 변경사항 감지 / 삭제 작업이 빠름.

### 장점

1. 패키지의 모든 의존성은 `.pnp.cjs` 파일을 이용하여 관리되기 때문에 더 이상 외부 환경에 영향받지 않음.
2. 더 이상 설치를 위해 깊은 node_modules 디렉토리를 생성하지 않아도 됨.
    
    → node_modules는 의존성이 올바르게 설치가 안 된다면 다시 재설치를 하는데, 디렉터리 구조를 다시 재생성 하느라 시간이 오래 걸렸는데 Yarn PnP에서는 zip을 활용하여 패키지를 관리하기 때문에 빠진 거나 변경 사항을 찾기 쉬움.
    
3. 각 패키지들은 package.json 파일에 기술하는 의존성에만 접근하기 때문에 엄격하게 관리되어 예기치못한 버그 예방 가능.

## Zero-Install

<aside>
📎 의존성을 용량이 적고 파일 갯수도 적기 때문에 Git에서 버전관리를 하는 것

</aside>

 PnP는 의존성을 압축 파일로 관리해서 용량이 작음. 

각 의존성은 Zip 파일 하나로 있어서 의존성을 구성하는 파일의 갯수가 많지 않음.

저장소를 복제하거나 브랜치를 바꿔도 yarn install을 하지 않아도 됨.

 CI에서 의존성 설치하는 시간이 줄어듬. 

Git에서 clone을 한다면 바로 사용이 가능하기 때문임.

→ 프로젝트 빌드 환경을 개선시키기 위해 Zero install을 적용
